# EnvHaven tmux config - minimal, clean

# Modern terminal settings
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# No delay on escape
set -sg escape-time 0

# Mouse support
set -g mouse on

# Copy mode - vi keys, clipboard bridge
setw -g mode-keys vi
set -s set-clipboard on
set -s allow-passthrough on
set -g copy-command "cat > /tmp/.envhaven-clipboard"

# Copy bindings - write to clipboard file, flash hint in status bar
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel \; run-shell -b /opt/envhaven/bin/tmux-copy-hint
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel \; run-shell -b /opt/envhaven/bin/tmux-copy-hint
bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel \; run-shell -b /opt/envhaven/bin/tmux-copy-hint

# Start windows/panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Increase scrollback
set -g history-limit 50000

# Status bar - minimal, bottom, with padding
set -g status-position bottom
set -g status 3
set -g status-style "bg=default,fg=#a0a0a0"
set -g status-format[0] ""
set -g status-format[1] "#[align=left]#[range=session]#[fg=#6b6b6b]#S#[norange] #[fg=#3b3b3b]|#[default] #{W:#[range=window|#{window_index}]#{E:window-status-format}#[norange],#[range=window|#{window_index}]#{E:window-status-current-format}#[norange]}#{?client_prefix,#[fg=#5b5b5b nobold] (shift+click to close),}#[align=right]#{E:status-right}"
set -g status-format[2] ""
set -g status-right "#{?client_prefix,#[fg=#a78bfa bold]n #[fg=#5b5b5b nobold]new  #[fg=#a78bfa bold]x #[fg=#5b5b5b nobold]close  #[fg=#a78bfa bold]esc #[fg=#5b5b5b nobold]cancel,#[fg=#a78bfa bold]ctrl+b #[fg=#5b5b5b nobold]options Â· #(cat /tmp/envhaven-version-status 2>/dev/null || echo $ENVHAVEN_VERSION)}"
set -g status-right-length 100

# Window list styling
# Normal: name colored | Prefix: number colored (hotkey)
set -g status-justify left
setw -g window-status-format "#{?client_prefix,#[fg=#a78bfa bold] #I #[fg=#5b5b5b nobold]#W ,#[fg=#6b6b6b nobold] #I #W }"
setw -g window-status-current-format "#{?client_prefix,#[fg=#a78bfa bold] #I #[fg=#5b5b5b nobold]#W ,#[fg=#6b6b6b nobold] #I #[fg=#a78bfa bold]#W }"
setw -g window-status-separator ""

# One session, multiple windows
# Click to switch, shift-click to close
unbind w
bind n new-window -c /config/workspace
bind x kill-pane
bind -n S-MouseDown1Status kill-window -t =

# Pane borders - subtle
set -g pane-border-style "fg=#3b3b3b"
set -g pane-active-border-style "fg=#6b6b6b"

# Messages
set -g message-style "bg=default,fg=#a78bfa"

# No visual bell
set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
setw -g monitor-activity off
set -g bell-action none
